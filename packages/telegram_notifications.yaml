################################################################################
# /packages/telegram_notifications.yaml
################################################################################
#
# –≠—Ç–æ—Ç –ø–∞–∫–µ—Ç Home Assistant —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
# —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# –æ —Å–æ–±—ã—Ç–∏—è—Ö –≤ ¬´—É–º–Ω–æ–º –¥–æ–º–µ¬ª. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç:
# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏:
#    ‚Ä¢ –ó–∞–ø—É—Å–∫–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–∏ Home Assistant.
#    ‚Ä¢ –û—Ç–∫—Ä—ã—Ç–∏–∏ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏ –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞.
#    ‚Ä¢ –ü—Ä–æ–≥–Ω–æ–∑–µ –ø–æ–≥–æ–¥—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.
#    ‚Ä¢ –ó–≤–æ–Ω–∫–µ –≤ –¥–≤–µ—Ä—å.
#    ‚Ä¢ –í–∫–ª—é—á–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã (–≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è/–¥–Ω–∏).
#    ‚Ä¢ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å—Ç–∏—Ä–∫–∏.
#    ‚Ä¢ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å –ø–æ–º–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º CO2.
#    ‚Ä¢ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏—è –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω—è CO2.
#    ‚Ä¢ –ü–æ–Ω–∏–∂–µ–Ω–∏–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤ –ø–æ–º–µ—â–µ–Ω–∏—è—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–π –¥–≤–µ—Ä–∏/–æ–∫–Ω–µ.
#    ‚Ä¢ –ù–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–π –≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (—Å –ø–æ–º–æ—â—å—é blueprint).
#    ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤/–ø–ª–∞–≥–∏–Ω–æ–≤.
#    ‚Ä¢ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–º–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä–∞ –≤ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–µ.
#
################################################################################

automation:
  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã
  # ----------------------------------------------------------------------------
  # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Telegram –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã.
  # –¢—Ä–∏–≥–≥–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 07:45:00 (–∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ).
  # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ –ê–Ω–¥—Ä–µ—é (notify.master) –∏ –¢–∞—Ç—å—è–Ω–µ (notify.tatiana).
  # –í–∫–ª—é—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–≥–æ–¥—É –∏ –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å.
  # ----------------------------------------------------------------------------
  - id: "ac0837cf-9ecb-413b-96fb-89552934212d"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã"
    description: "–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –≤ –¢–µ–ª–µ–≥—Ä–∞–º –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ."
    trigger:
      - platform: time
        at: "07:45:00"
    action:
      - action: notify.master
        data:
          title: "<b>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ <u>{{ now().strftime('%d.%m.%Y') }}</u></b>"
          message: >-
            {% set condition = states('sensor.open_meteo_opisanie_na_russkom') %}
            {% if condition == '—è—Å–Ω–æ' %}‚òÄÔ∏è{% elif condition == '–º–∞–ª–æ–æ–±–ª–∞—á–Ω–æ' %}‚õÖ
            {% elif condition == '–æ–±–ª–∞—á–Ω–æ —Å –ø—Ä–æ—è—Å–Ω–µ–Ω–∏—è–º–∏' %}‚òÅÔ∏è{% elif condition == '–ø–∞—Å–º—É—Ä–Ω–æ' %}üå•
            {% elif condition == '—Ç—É–º–∞–Ω' %}üå´{% elif condition == '–º–æ—Ä–æ—Å—å' %}üå¶
            {% elif condition == '–¥–æ–∂–¥–ª–∏–≤–æ' %}üåß{% elif condition == '–Ω–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å' %}üå¶
            {% elif condition == '–¥–æ–∂–¥—å' %}üåß{% elif condition == '–ª–∏–≤–µ–Ω—å' %}‚õà
            {% elif condition == '—Å–Ω–µ–≥' %}‚ùÑÔ∏è{% elif condition == '—Å–∏–ª—å–Ω—ã–π —Å–Ω–µ–≥' %}üå®
            {% elif condition == '–¥–æ–∂–¥—å —Å–æ —Å–Ω–µ–≥–æ–º' %}üåß‚ùÑÔ∏è{% elif condition == '–≥—Ä–æ–∑–∞' %}‚ö°
            {% else %}üåà{% endif %} <b>–°–µ–π—á–∞—Å:</b> {{ condition }}

            üå° <b>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</b> {{ state_attr('weather.kvartira_133', 'temperature') }}¬∞C
            üå¨ <b>–í–µ—Ç–µ—Ä:</b> {{ states('sensor.open_meteo_weather4notion_wind') }}, {{ state_attr('weather.kvartira_133', 'wind_speed') }} –º/—Å

            {% if state_attr('weather.kvartira_133', 'precipitation_unit') == 'mm' %}
            üåß <b>–û—Å–∞–¥–∫–∏:</b> –û–∂–∏–¥–∞—é—Ç—Å—è
            {% else %}
            ‚òÄ <b>–û—Å–∞–¥–∫–∏:</b> –ù–µ –æ–∂–∏–¥–∞—é—Ç—Å—è
            {% endif %}

            <b>üìÖ –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</b>

            {% for forecast in state_attr('weather.yandex_weather', 'forecast') | default([]) %}
              {%- set forecast_date_str = forecast.datetime | string -%}
              {%- set forecast_date = forecast_date_str | as_datetime -%}
              {%- if forecast_date.date() == now().date() -%}
                {%- set icon = state_attr('weather.yandex_weather', 'forecast_icons')[loop.index0] 
                  | replace('ovc', '‚òÅÔ∏è') 
                  | replace('skc', '‚òÄÔ∏è') 
                  | replace('bkn', '‚õÖ') 
                  | replace('pc', 'üå§') 
                  | replace('-ra', 'üåß') 
                  | replace('-sn', '‚ùÑÔ∏è') 
                  | replace('ts', '‚õà') 
                  | replace('_ra_sn', 'üåß‚ùÑÔ∏è') -%}
                  
                <b>{{ forecast_date | as_local | as_timestamp | timestamp_custom('%H:%M') }}</b> {{ icon }}
                ‚ñ∏ {{ states('sensor.yandex_weather4notion_conditions') }}
                ‚ñ∏ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ forecast.temperature }}¬∞C
                ‚ñ∏ –í–µ—Ç–µ—Ä: {{ states('sensor.yandex_weather4notion_wind') }}
                ‚ñ∏ {% if 'precipitation' in forecast and forecast.precipitation | float > 0 -%}
                  üåß {{ forecast.precipitation }} –º–º ({{ forecast.precipitation_probability }}%)
                  {%- else -%}
                  ‚òÄ –ë–µ–∑ –æ—Å–∞–¥–∫–æ–≤
                  {%- endif %}

              {%- endif %}
            {% endfor %}

            <b>–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ:</b> {{ state_attr('weather.yandex_weather', 'pressure') | round(2) }} –º–º —Ä—Ç.—Å—Ç.
            (<i>{{ '‚¨ÜÔ∏è –≤—ã—à–µ –Ω–æ—Ä–º—ã' if state_attr('weather.yandex_weather', 'pressure') > 740 else '‚¨áÔ∏è –Ω–∏–∂–µ –Ω–æ—Ä–º—ã' if state_attr('weather.yandex_weather', 'pressure') < 738 else 'üü¢ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ' }}</i>)
      - action: notify.tatiana
        data:
          title: "<b>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ <u>{{ now().strftime('%d.%m.%Y') }}</u></b>"
          message: >-
            {% set condition = states('sensor.open_meteo_opisanie_na_russkom') %}
            {% if condition == '—è—Å–Ω–æ' %}‚òÄÔ∏è{% elif condition == '–º–∞–ª–æ–æ–±–ª–∞—á–Ω–æ' %}‚õÖ
            {% elif condition == '–æ–±–ª–∞—á–Ω–æ —Å –ø—Ä–æ—è—Å–Ω–µ–Ω–∏—è–º–∏' %}‚òÅÔ∏è{% elif condition == '–ø–∞—Å–º—É—Ä–Ω–æ' %}üå•
            {% elif condition == '—Ç—É–º–∞–Ω' %}üå´{% elif condition == '–º–æ—Ä–æ—Å—å' %}üå¶
            {% elif condition == '–¥–æ–∂–¥–ª–∏–≤–æ' %}üåß{% elif condition == '–Ω–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å' %}üå¶
            {% elif condition == '–¥–æ–∂–¥—å' %}üåß{% elif condition == '–ª–∏–≤–µ–Ω—å' %}‚õà
            {% elif condition == '—Å–Ω–µ–≥' %}‚ùÑÔ∏è{% elif condition == '—Å–∏–ª—å–Ω—ã–π —Å–Ω–µ–≥' %}üå®
            {% elif condition == '–¥–æ–∂–¥—å —Å–æ —Å–Ω–µ–≥–æ–º' %}üåß‚ùÑÔ∏è{% elif condition == '–≥—Ä–æ–∑–∞' %}‚ö°
            {% else %}üåà{% endif %} <b>–°–µ–π—á–∞—Å:</b> {{ condition }}

            üå° <b>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</b> {{ state_attr('weather.kvartira_133', 'temperature') }}¬∞C
            üå¨ <b>–í–µ—Ç–µ—Ä:</b> {{ states('sensor.open_meteo_weather4notion_wind') }}, {{ state_attr('weather.kvartira_133', 'wind_speed') }} –º/—Å

            {% if state_attr('weather.kvartira_133', 'precipitation_unit') == 'mm' %}
            üåß <b>–û—Å–∞–¥–∫–∏:</b> –û–∂–∏–¥–∞—é—Ç—Å—è
            {% else %}
            ‚òÄ <b>–û—Å–∞–¥–∫–∏:</b> –ù–µ –æ–∂–∏–¥–∞—é—Ç—Å—è
            {% endif %}

            <b>üìÖ –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:</b>

            {% for forecast in state_attr('weather.yandex_weather', 'forecast') | default([]) %}
              {%- set forecast_date_str = forecast.datetime | string -%}
              {%- set forecast_date = forecast_date_str | as_datetime -%}
              {%- if forecast_date.date() == now().date() -%}
                {%- set icon = state_attr('weather.yandex_weather', 'forecast_icons')[loop.index0] 
                  | replace('ovc', '‚òÅÔ∏è') 
                  | replace('skc', '‚òÄÔ∏è') 
                  | replace('bkn', '‚õÖ') 
                  | replace('pc', 'üå§') 
                  | replace('-ra', 'üåß') 
                  | replace('-sn', '‚ùÑÔ∏è') 
                  | replace('ts', '‚õà') 
                  | replace('_ra_sn', 'üåß‚ùÑÔ∏è') -%}
                  
                <b>{{ forecast_date | as_local | as_timestamp | timestamp_custom('%H:%M') }}</b> {{ icon }}
                ‚ñ∏ {{ states('sensor.yandex_weather4notion_conditions') }}
                ‚ñ∏ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ forecast.temperature }}¬∞C
                ‚ñ∏ –í–µ—Ç–µ—Ä: {{ states('sensor.yandex_weather4notion_wind') }}
                ‚ñ∏ {% if 'precipitation' in forecast and forecast.precipitation | float > 0 -%}
                  üåß {{ forecast.precipitation }} –º–º ({{ forecast.precipitation_probability }}%)
                  {%- else -%}
                  ‚òÄ –ë–µ–∑ –æ—Å–∞–¥–∫–æ–≤
                  {%- endif %}

              {%- endif %}
            {% endfor %}

            <b>–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ:</b> {{ state_attr('weather.yandex_weather', 'pressure') | round(2) }} –º–º —Ä—Ç.—Å—Ç.
            (<i>{{ '‚¨ÜÔ∏è –≤—ã—à–µ –Ω–æ—Ä–º—ã' if state_attr('weather.yandex_weather', 'pressure') > 740 else '‚¨áÔ∏è –Ω–∏–∂–µ –Ω–æ—Ä–º—ã' if state_attr('weather.yandex_weather', 'pressure') < 738 else 'üü¢ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ' }}</i>)

    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –û—Ç–∫—Ä—ã—Ç–∏–µ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏
  # ----------------------------------------------------------------------------
  # –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ê–Ω–¥—Ä–µ—é (notify.master), –µ—Å–ª–∏ –¥–≤–µ—Ä—å
  # –æ—Ç–∫—Ä—ã–ª–∞—Å—å, –∞ –æ–Ω (master) –Ω–µ –¥–æ–º–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∏–≥–Ω–∞–ª–æ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ
  # –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –∏–ª–∏ –∫–æ–≥–æ-—Ç–æ –¥—Ä—É–≥–æ–≥–æ, –∫—Ç–æ –ø—Ä–∏—à—ë–ª –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞.
  # ----------------------------------------------------------------------------
  - id: "1f7e3ae4-268e-4afa-a7e6-d395821f244b"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –û—Ç–∫—Ä—ã—Ç–∏–µ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏"
    description: "–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–≤–µ—Ä–∏, –µ—Å–ª–∏ master –Ω–µ –¥–æ–º–∞ –∏ —Ä–µ–∂–∏–º —É–±–æ—Ä–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω."
    triggers:
      - trigger: device
        device_id: abd3e40b49cfbe61411bac5d87bf000f
        entity_id: binary_sensor.hallway_door_contact
        domain: binary_sensor
        type: opened
    conditions:
      # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ master –Ω–µ –¥–æ–º–∞
      - condition: state
        entity_id: person.master
        state: "not_home"
      # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ä–µ–∂–∏–º —É–±–æ—Ä–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: input_boolean.bathroom_cleaning_mode
        state: "off"
    actions:
      - action: notify.master
        data:
          message: "‚ö†Ô∏è <b>–û—Ç–∫—Ä—ã—Ç–∏–µ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏!</b> üîì"
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –ó–≤–æ–Ω–æ–∫ –≤ –¥–≤–µ—Ä—å
  # ----------------------------------------------------------------------------
  # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É, –Ω–æ —Ç—Ä–∏–≥–≥–µ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è —Å–∏–≥–Ω–∞–ª –æ –∑–≤–æ–Ω–∫–µ
  # (MQTT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ). –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ê–Ω–¥—Ä–µ—é, –µ—Å–ª–∏ –º–∞—Å—Ç–µ—Ä –Ω–µ –¥–æ–º–∞.
  # ----------------------------------------------------------------------------
  - id: "eaddf6dd-762d-487e-9bf2-ba018f10b742"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–≤–æ–Ω–∫–µ –≤ –¥–≤–µ—Ä—å"
    triggers:
      - trigger: device
        domain: mqtt
        device_id: d2c3001cdc59660c456de45aec09da91
        type: action
        subtype: single
    conditions:
      # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ master –Ω–µ –¥–æ–º–∞
      - condition: state
        entity_id: person.master
        state: "not_home"
      # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ä–µ–∂–∏–º —É–±–æ—Ä–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω
      - condition: state
        entity_id: input_boolean.bathroom_cleaning_mode
        state: "off"
    actions:
      - action: notify.master
        data:
          message: "‚ö†Ô∏è <b>–ö—Ç–æ-—Ç–æ –∑–≤–æ–Ω–∏—Ç –≤ –¥–≤–µ—Ä—å</b>"
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
  # ----------------------------------------------------------------------------
  # –î–∞–Ω–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–∞–º–µ—Ä—ã (switch.chuangmi_ipc019_37da_switch_status).
  # –£—Å–ª–æ–≤–∏—è:
  #   - –ü–Ω‚Äì–ü—Ç: 09:00:00 ‚Äì 23:59:59
  #   - –°–±‚Äì–í—Å: 00:00:00 ‚Äì 23:59:59 (—Ç.–µ. –≤—ã—Ö–æ–¥–Ω—ã–µ –∫–æ–≥–¥–∞ —É–≥–æ–¥–Ω–æ).
  # –í—ã–±–∏—Ä–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º (messages | random).
  # ----------------------------------------------------------------------------
  - id: "417016e0-21fa-4ec3-a057-35deaa7a93f2"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –í–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã"
    triggers:
      - platform: state
        entity_id: group.cameras
        to: "on"
    conditions:
      - condition: or
        conditions:
          - condition: time
            weekday:
              - mon
              - tue
              - wed
              - thu
              - fri
            after: "09:00:00"
            before: "23:59:59"
          - condition: time
            weekday:
              - sat
              - sun
            after: "00:00:00"
            before: "23:59:59"
    actions:
      - choose:
          conditions:
            - condition: template
              value_template: "{{ now().weekday() in [5, 6] }}"
          sequence:
            - action: notify.master
              data:
                message: >
                  {% set messages = [
                    "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ö–∞–º–µ—Ä—ã –≤–∫–ª—é—á–µ–Ω—ã! üé•",
                    "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ö–∞–º–µ—Ä—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã! üé•",
                    "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ö–∞–º–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç! üé•"
                  ] %}
                  {{ messages | random }}
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
  # ----------------------------------------------------------------------------
  # –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Home Assistant (event: start) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ
  # —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram –∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É (ha_wakeup.png).
  # ----------------------------------------------------------------------------
  - id: "686a3440-7629-4b55-b508-593caf3679af"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞"
    triggers:
      - trigger: homeassistant
        event: start
    actions:
      - action: notify.master
        data:
          message: >
            {{ ["Home assistant started!", "Home assistant is running now!", "Home assistant has begun!", "HA has started!"] | random }}
          data:
            photo:
              - file: "/config/www/images/notify_alert/ha_wakeup.png"
                caption: "{{ ['Home assistant started!', 'Home assistant is running now!', 'Home assistant has begun!', 'HA has started!'] | random }}"
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –°–µ—Ä–≤–µ—Ä –æ—Ç–∫–ª—é—á—ë–Ω
  # ----------------------------------------------------------------------------
  # –ü—Ä–∏ —Å–∏–≥–Ω–∞–ª–µ "shutdown" Home Assistant –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä
  # –æ—Ç–∫–ª—é—á–µ–Ω, –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É (ha_shutdown.png).
  # ----------------------------------------------------------------------------
  - id: "c8dc47aa-90f0-4522-b71e-4e99bbfe6c76"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –°–µ—Ä–≤–µ—Ä –æ—Ç–∫–ª—é—á—ë–Ω"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞"
    triggers:
      - trigger: homeassistant
        event: shutdown
    actions:
      - action: notify.master
        data:
          message: >
            {{ ['Home Assistant shutdown', 'Shutdown of Home Assistant', 'HA has been shut down'] | random }}
          data:
            photo:
              - file: "/config/www/images/notify_alert/ha_shutdown.png"
                caption: "{{ ['Home Assistant shutdown', 'Shutdown of Home Assistant', 'HA has been shut down'] | random }}"
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø–∏—Ç–∞–Ω–∏—è (—á–µ—Ä–µ–∑ Blueprint)
  # ----------------------------------------------------------------------------
  # –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –≥–æ—Ç–æ–≤—ã–º –±–ª—É–ø—Ä–∏–Ω—Ç–æ–º (sbyx/low-battery-level-detection-notification).
  # –ü–æ—Ä–æ–≥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 15%. –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ notify.master,
  # —É–ø–æ–º–∏–Ω–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–µ–Ω—Å–æ—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –±–∞—Ç–∞—Ä–µ—è —É–ø–∞–ª–∞ –Ω–∏–∂–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞.
  # ----------------------------------------------------------------------------
  - id: "04c57ac3-56ec-49aa-a30a-4b3bd973eb60"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø–∏—Ç–∞–Ω–∏—è"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–º–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è"
    use_blueprint:
      path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
      input:
        threshold: 15
        actions:
          - action: notify.master
            metadata: {}
            data:
              message: '"–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∑–∞–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è: {{sensors}}"'

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞/–ø–ª–∞–≥–∏–Ω–∞
  # ----------------------------------------------------------------------------
  # –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –ª—é–±–æ–π –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö update.*_update –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ 'on'.
  # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–µ—Ä–µ—á–∏—Å–ª—è—è –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —Ç–µ–∫—É—â—É—é –∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é
  # –≤–µ—Ä—Å–∏—é. –¢–∞–∫–∂–µ –ø—Ä–∏–ª–∞–≥–∞–µ—Ç—Å—è release_summary, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –∞—Ç—Ä–∏–±—É—Ç–∞—Ö.
  # ----------------------------------------------------------------------------
  - id: "4c5c8e57-be5b-4380-88a1-4ecc730c19da"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –í–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–∏—Å—Ç–µ–º—ã"
    triggers:
      - trigger: state
        entity_id:
          - update.file_editor_update
          - update.home_assistant_core_update
          - update.home_assistant_google_drive_backup_update
          - update.home_assistant_operating_system_update
          - update.home_assistant_supervisor_update
          - update.log_viewer_update
          - update.mosquitto_broker_update
          - update.studio_code_server_update
          - update.advanced_ssh_web_terminal_update
          - update.zigbee2mqtt_update
          - update.ps5_mqtt_update
        to: "on"
    actions:
      - action: notify.master
        data_template:
          message: >
            {% set entity = trigger.to_state %}
            {% if entity %}
              üÜï –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ: {{ entity.attributes.friendly_name | default('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç') }}
              –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: {{ entity.attributes.installed_version | default('–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ') }}
              –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è: {{ entity.attributes.latest_version | default('–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ') }}
              üìù –°–≤–æ–¥–∫–∞: {{ entity.attributes.release_summary | default('–ù–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π') }}
            {% else %}
              –û—à–∏–±–∫–∞: –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.
            {% endif %}
  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –º–∞—Å—Å–∞–∂—ë—Ä–∞
  # ----------------------------------------------------------------------------
  # –¢—Ä–∏–≥–≥–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏ –º–∞—Å—Å–∞–∂—ë—Ä–∞ –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ 30%
  # –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  # ----------------------------------------------------------------------------
  - id: "ab45665b-4995-448d-b180-c0e1d77184e9"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –º–∞—Å—Å–∞–∂—ë—Ä–∞"
    triggers:
      - platform: numeric_state
        entity_id: sensor.soocare_cn_1083009681_m14_battery_level_p_3_1
        below: 30
    conditions:
      # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ —Ñ–∞–∑–∞ –∑–∞–≥—Ä—É–∑–∫–∏
      - condition: state
        entity_id: input_boolean.system_startup_phase
        state: "off"
    actions:
      - service: notify.master
        data:
          message: "‚ö†Ô∏è <b>–ú–∞—Å—Å–∞–∂—ë—Ä –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –∑–∞—Ä—è–¥–∫–µ!</b>"
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –ü—Ä–æ–±–ª–µ–º—ã —Å –∂–µ—Å—Ç–∫–∏–º–∏ –¥–∏—Å–∫–∞–º–∏ Proxmox
  # ----------------------------------------------------------------------------
  - id: "daa17acf-7c8a-4a8e-9fd0-4f2c5348c814"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ü—Ä–æ–±–ª–µ–º—ã —Å –∂–µ—Å—Ç–∫–∏–º–∏ –¥–∏—Å–∫–∞–º–∏ Proxmox"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∂–µ—Å—Ç–∫–∏–º–∏ –¥–∏—Å–∫–∞–º–∏ Proxmox."
    trigger:
      - platform: state
        entity_id: binary_sensor.disk_pve_h_w_raid1_dev_sdb_health
        to: "on"
      - platform: state
        entity_id: binary_sensor.disk_pve_128gb_ssd_dev_sda_health
        to: "on"
    action:
      - service: notify.master
        data:
          message: >-
            ‚ö†Ô∏è <b>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –∂–µ—Å—Ç–∫–∏–º –¥–∏—Å–∫–æ–º Proxmox!</b>
            {% if trigger.entity_id == 'binary_sensor.disk_pve_h_w_raid1_dev_sdb_health' %}
            üî¥ –í–Ω–µ—à–Ω–∏–π RAID –º–∞—Å—Å–∏–≤ (sdb) —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è!
            {% elif trigger.entity_id == 'binary_sensor.disk_pve_128gb_ssd_dev_sda_health' %}
            üî¥ –û—Å–Ω–æ–≤–Ω–æ–π –¥–∏—Å–∫ —Å–∏—Å—Ç–µ–º—ã (sda) —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è!
            {% endif %}
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∏—Å–∫–∞ Proxmox
  # ----------------------------------------------------------------------------
  - id: "4751a90b-0134-4906-84f0-e5b1a7cb02c2"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∏—Å–∫–∞ Proxmox"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –¥–∏—Å–∫ Proxmox –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 90%."
    trigger:
      - platform: numeric_state
        entity_id: sensor.node_pve_disk_used_percentage
        above: 90
    action:
      - service: notify.master
        data:
          message: >-
            ‚ö†Ô∏è <b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∏—Å–∫–∞ –Ω–∞ Proxmox!</b>
            –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞: {{ states('sensor.node_pve_disk_used_percentage') }}%.
    mode: single

  # ----------------------------------------------------------------------------
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: –î–æ—Å—Ç—É–ø–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è Proxmox
  # ----------------------------------------------------------------------------
  - id: "ab5c1bd2-8756-4736-9909-52766bf989bd"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –î–æ—Å—Ç—É–ø–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è Proxmox"
    description: "–°–æ–æ–±—â–∞–µ—Ç –æ –Ω–∞–ª–∏—á–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏."
    trigger:
      - platform: state
        entity_id: binary_sensor.node_pve_updates_packages
        to: "on"
    action:
      - service: notify.master
        data:
          message: >-
            üîÑ <b>–î–æ—Å—Ç—É–ø–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è Proxmox!</b>
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: {{ states('sensor.node_pve_total_updates') }}.
            –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º—É –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
    mode: single
