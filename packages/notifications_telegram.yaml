# /packages/notifications_telegram.yaml #
#########################################

# –≠—Ç–æ—Ç –ø–∞–∫–µ—Ç Home Assistant —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Telegram –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
# —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ —Å–æ–±—ã—Ç–∏—è—Ö
# –≤ —É–º–Ω–æ–º –¥–æ–º–µ. –í–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
# –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∞ —Ç–∞–∫–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞
# —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ.

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Telegram Bot
# –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç polling –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π.
# API Key: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ—Ç–∞ –≤ Telegram.
# Parse Mode: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ HTML –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
# Allowed Chat IDs: –°–ø–∏—Å–æ–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ —á–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
# –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º.

telegram_bot:
  - platform: polling
    api_key: !secret api_key_bot
    parse_mode: html
    allowed_chat_ids:
      - !secret chat_id_andrei
      - !secret chat_id_tatsiana

# –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
# Andrei –∏ Tatsiana: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
# –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ –∏—Ö chat_id, –∫–æ—Ç–æ—Ä—ã–µ —Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ secret.yaml

notify:
  - name: master
    platform: telegram
    chat_id: !secret chat_id_andrei
  - name: Tatsiana
    platform: telegram
    chat_id: !secret chat_id_tatsiana

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –°—É—â–Ω–æ—Å—Ç–∏
# Input Text 'Currently Home': –°–ª—É–∂–∏—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,
# –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –¥–æ–º–∞. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
# –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

input_text:
  currently_home:
    name: "Currently Home"
    min: 0
    max: 255

# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

automation:
  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –°–ø–∏—Å–∫–∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –¥–æ–º–∞,
  # –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  # –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö.

  - id: "c6382818-05ed-4590-be92-b367489fb0e1"
    alias: "–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –¥–æ–º–∞"
    description: "–û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –¥–æ–º–∞, –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö."
    trigger:
      - platform: state
        entity_id:
          - person.master
          - person.tatiana
    action:
      - service: input_text.set_value
        target:
          entity_id: input_text.currently_home
        data:
          value: >
            {% set home_users = [] %}
            {% if is_state('person.master', 'home') %}
              {% set home_users = home_users + ['Andrei'] %}
            {% endif %}
            {% if is_state('person.tatiana', 'home') %}
              {% set home_users = home_users + ['Tatiana'] %}
            {% endif %}
            {{ home_users | join(', ') }}

  ## –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã
  # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≥–Ω–æ–∑–æ–º –ø–æ–≥–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
  # –≤ Telegram –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

  - id: "ac0837cf-9ecb-413b-96fb-89552934212d"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã"
    description: "–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –≤ –¢–µ–ª–µ–≥—Ä–∞–º –∫–∞–∂–¥–æ–µ —É—Ç—Ä–æ."
    trigger:
      - platform: time
        at: "07:45:00" # –£–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
    condition: []
    action:
      - service: notify.master
        data:
          title: "<b>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</b>"
          message: >
            –°–µ–π—á–∞—Å {{ states('sensor.open_meteo_opisanie_na_russkom') }}. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ state_attr('weather.kvartira_133', 'temperature') }}¬∞C. –í–µ—Ç–µ—Ä {{ states('sensor.open_meteo_weather4notion_wind') }}, {{ state_attr('weather.kvartira_133', 'wind_speed') }} –º/—Å. {% if state_attr('weather.kvartira_133', 'precipitation_unit') == 'mm' %}–û–∂–∏–¥–∞—é—Ç—Å—è –æ—Å–∞–¥–∫–∏.{% else %}–û—Å–∞–¥–∫–æ–≤ –Ω–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è.{% endif %}
      - service: notify.tatsiana
        data:
          title: "<b>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</b>"
          message: >
            –°–µ–π—á–∞—Å {{ states('sensor.open_meteo_opisanie_na_russkom') }}. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ state_attr('weather.kvartira_133', 'temperature') }}¬∞C. –í–µ—Ç–µ—Ä {{ state_attr('weather.kvartira_133', 'wind_speed') }} –º/—Å, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ {{ states('sensor.open_meteo_weather4notion_wind') }}. {% if state_attr('weather.kvartira_133', 'precipitation_unit') == 'mm' %}–û–∂–∏–¥–∞—é—Ç—Å—è –æ—Å–∞–¥–∫–∏.{% else %}–û—Å–∞–¥–∫–æ–≤ –Ω–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è.{% endif %}
    mode: single

  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏
  # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≥–Ω–æ–∑–æ–º –ø–æ–≥–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
  # –≤ Telegram –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

  - id: "1f7e3ae4-268e-4afa-a7e6-d395821f244b"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –û—Ç–∫—Ä—ã—Ç–∏–µ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏"
    description: "–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–≤–µ—Ä–∏, –µ—Å–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –¥–æ–º–∞"
    trigger:
      - type: opened
        platform: device
        device_id: abd3e40b49cfbe61411bac5d87bf000f
        entity_id: binary_sensor.hallway_door_contact
        domain: binary_sensor
    condition:
      - condition: state
        entity_id: person.master
        state: "not_home"
    action:
      - service: notify.master
        data:
          message: "‚ö†Ô∏è –û—Ç–∫—Ä—ã—Ç–∏–µ –≤—Ö–æ–¥–Ω–æ–π –¥–≤–µ—Ä–∏! üîì"
    mode: single

  - id: "857652d8-a81f-4297-bf5a-824030aca70a"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–≤–æ–Ω–∫–µ –≤ –¥–≤–µ—Ä—å"
    trigger:
      - platform: device
        domain: mqtt
        device_id: d2c3001cdc59660c456de45aec09da91
        type: action
        subtype: single
    condition:
      - condition: state
        entity_id: person.master
        state: "not_home"
    action:
      - service: notify.master
        data:
          message: "‚ö†Ô∏è –ö—Ç–æ-—Ç–æ –∑–≤–æ–Ω–∏—Ç –≤ –¥–≤–µ—Ä—å"
    mode: single

  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã

  - id: "417016e0-21fa-4ec3-a057-35deaa7a93f2"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã"
    trigger:
      - platform: state
        entity_id: switch.chuangmi_ipc019_37da_switch_status
        to: "on"
    condition:
      - condition: or
        conditions:
          - condition: time
            weekday:
              - mon
              - tue
              - wed
              - thu
              - fri
            after: "09:00:00"
            before: "02:00:00"
          - condition: time
            weekday:
              - sat
              - sun
            after: "00:00:00"
            before: "23:59:59"
    action:
      - choose:
          - conditions:
              - condition: template
                value_template: "{{ now().weekday() in [5, 6] }}"
            sequence:
              - service: notify.master
                data:
                  message: >
                    {% set messages = [
                      "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ö–∞–º–µ—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞! üé•",
                      "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ö–∞–º–µ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞! üé•",
                      "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ö–∞–º–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç! üé•"
                    ] %}
                    {{ messages | random }}
    mode: single

  - id: "ba69e825-6c4e-4451-bb6f-cbbb224b1631"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å—Ç–∏—Ä–∫–∏"
    trigger:
      - platform: state
        entity_id: binary_sensor.washing_machine_finished
        to: "on"
        for:
          minutes: 5
    condition:
      - condition: state
        entity_id: sensor.washing_machine_active
        state: "off"
      - condition: template
        value_template: >
          {{ is_state('sensor.washing_machine_active', 'on') and
            (as_timestamp(now()) - as_timestamp(states.sensor.washing_machine_active.last_changed)) >= 840 }}
        # 840 —Å–µ–∫—É–Ω–¥ = 14 –º–∏–Ω—É—Ç
    action:
      - service: notify.master
        data:
          message: "üè† –°—Ç–∏—Ä–∫–∞ –∑–∞–∫–æ–Ω—á–µ–Ω–∞! üßº"

  # –ò–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –∑–∞–ø—É—Å–∫–µ –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ Home Assistant.
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –°—Ç–∞—Ä—Ç–µ –∏ –û—Å—Ç–∞–Ω–æ–≤–∫–µ Home Assistant
  # –°—Ç–∞—Ä—Ç —Å–∏—Å—Ç–µ–º—ã

  - id: "686a3440-7629-4b55-b508-593caf3679af"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞"
    trigger:
      - platform: homeassistant
        event: start
    action:
      - service: notify.master
        data:
          message: >
            {{ ["Home assistant started!", "Home assistant is running now!", "Home assistant has begun!", "HA has started!"] | random }}
          data:
            photo:
              - file: "/config/www/images/notify_alert/ha_wakeup.png"
                caption: "{{ ['Home assistant started!', 'Home assistant is running now!', 'Home assistant has begun!', 'HA has started!'] | random }} "
    mode: single

  # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

  - id: "c8dc47aa-90f0-4522-b71e-4e99bbfe6c76"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –°–µ—Ä–≤–µ—Ä –æ—Ç–∫–ª—é—á—ë–Ω"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞"
    trigger:
      - platform: homeassistant
        event: shutdown
    action:
      - service: notify.master
        data:
          message: >
            {{ ['Home Assistant shutdown', 'Shutdown of Home Assistant', 'HA has been shut down'] | random }}
          data:
            photo:
              - file: "/config/www/images/notify_alert/ha_shutdown.png"
                caption: "{{ ['Home Assistant shutdown', 'Shutdown of Home Assistant', 'HA has been shut down'] | random }}"
    mode: single

  # –ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –ö–æ–º–Ω–∞—Ç
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏—è –∏–∑-–∑–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è CO2 –∏
  # –æ–± —É—Ä–æ–≤–Ω–µ CO2, –≤–µ—Ä–Ω—É–≤—à–µ–º—Å—è –≤ –Ω–æ—Ä–º—É –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏—è.

  - id: "dca1ab9b-889a-4d29-9376-558f2d8e3cfd"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å –≥–æ—Å—Ç–∏–Ω—É—é"
    description: "–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å CO2 –≤—ã—Å–æ–∫."
    trigger:
      platform: state
      entity_id: sensor.livingroom_ventilation_need
      from: "off"
      to: "on"
    condition:
      - condition: state
        entity_id: input_boolean.silent_mode
        state: "off"
      - condition: state
        entity_id: input_boolean.co2_text_notification_sensor
        state: "off"
      - condition: state
        entity_id: input_boolean.system_startup_phase
        state: "off"
    action:
      - condition: state
        entity_id: person.master
        state: "not_home"
      - service: notify.master
        data:
          message: "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å –ø–æ–º–µ—â–µ–Ω–∏–µ –≥–æ—Å—Ç–∏–Ω—É—é"
          data:
            photo:
              file: "/config/www/images/notify_alert/ha_co2_alert.png"
              caption: "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å –ø–æ–º–µ—â–µ–Ω–∏–µ"
      - condition: state
        entity_id: person.tatiana
        state: "not_home"
      - service: notify.tatsiana
        data:
          message: "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å –ø–æ–º–µ—â–µ–Ω–∏–µ –≥–æ—Å—Ç–∏–Ω—É—é"
          data:
            photo:
              file: "/config/www/images/notify_alert/ha_co2_alert.png"
              caption: "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å –ø–æ–º–µ—â–µ–Ω–∏–µ –≥–æ—Å—Ç–∏–Ω—É—é"
      - service: input_boolean.turn_on
        entity_id: input_boolean.co2_text_notification_sensor
    mode: single


### –£—Ä–æ–≤–µ–Ω—å –°–û2 –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã
  - id: "e531db4f-e947-460b-a9b3-2d71648bc465"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –≤ –≥–æ—Å—Ç–∏–Ω–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
    trigger:
      - platform: state
        entity_id: sensor.livingroom_ventilation_status
        from: "off"
        to: "on"
    condition:
      - condition: state
        entity_id: input_boolean.silent_mode
        state: "off"
      - condition: state
        entity_id: input_boolean.co2_text_notification_sensor
        state: "off"
      - condition: state
        entity_id: input_boolean.system_startup_phase
        state: "off"
      - condition: template
        value_template: >
          {{ is_state('group.all_residents', 'not_home') }}
    action:
      - wait_for_trigger:
          - platform: state
            entity_id: sensor.livingroom_ventilation_status
            to: "off"
        continue_on_timeout: true
      - choose:
          - conditions:
              - condition: state
                entity_id: person.master
                state: "home"
            sequence:
              - service: notify.master
                data:
                  message: "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –£—Ä–æ–≤–µ–Ω—å CO2 –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã."
          - conditions:
              - condition: state
                entity_id: person.tatiana
                state: "home"
            sequence:
              - service: notify.tatsiana
                data:
                  message: "–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –£—Ä–æ–≤–µ–Ω—å CO2 –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã."
      - service: input_boolean.turn_on
        entity_id: input_boolean.ventilation_status_cool_down
      - service: input_boolean.turn_on
        entity_id: input_boolean.co2_text_notification_sensor
    mode: single


  # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ 20¬∞
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∫–æ–≥–¥–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∏–∂–µ 20¬∞C,
  # —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–∏ –≤ —Ö–æ–ª–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –≥–æ–¥–∞.

  # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ —Å–ø–∞–ª—å–Ω–µ –º–µ–Ω—å—à–µ 20 –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–∏

  - id: "c694ab76-109b-4199-ae0b-e56753b80ae0"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ —Å–ø–∞–ª—å–Ω–µ –Ω–∏–∂–µ 20¬∞"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –≤ —Å–ø–∞–ª—å–Ω–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–µ–ª–∞"
    trigger:
      - platform: numeric_state
        entity_id: sensor.bedroom_th_sensor_temperature
        below: 20
    condition:
      - condition: state
        entity_id: input_boolean.system_startup_phase
        state: "off"
      - condition: state
        entity_id: binary_sensor.0x00158d00044d5d11_contact
        state: "on"
    action:
      - condition: state
        entity_id: person.master
        state: "home"
      - service: notify.master
        data:
          message: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ —Å–ø–∞–ª—å–Ω–µ –Ω–∏–∂–µ 20¬∞. –î–∏–Ω–æ–∑–∞–≤—Ä—ã –ª—é–±—è—Ç —Ç–µ–ø–ª–æ! –ó–∞–∫—Ä–æ–π—Ç–µ –±–∞–ª–∫–æ–Ω –≤ —Å–ø–∞–ª—å–Ω–µ."
      - condition: state
        entity_id: person.tatiana
        state: "home"
      - service: notify.tatsiana
        data:
          message: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ —Å–ø–∞–ª—å–Ω–µ –Ω–∏–∂–µ 20¬∞. –î–∏–Ω–æ–∑–∞–≤—Ä—ã –ª—é–±—è—Ç —Ç–µ–ø–ª–æ! –ó–∞–∫—Ä–æ–π—Ç–µ –±–∞–ª–∫–æ–Ω –≤ —Å–ø–∞–ª—å–Ω–µ."
    mode: single

  ## –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π –º–µ–Ω—å—à–µ 20 –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–∏

  - id: "6d6b608d-26d9-4eb7-8a52-7163a91ed890"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π –Ω–∏–∂–µ 20¬∞"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–µ–ª–∞"
    trigger:
      - platform: numeric_state
        entity_id: sensor.cgllc_dove_f637_temperature_humidity_sensor
        below: 20
    condition:
      - condition: state
        entity_id: input_boolean.system_startup_phase
        state: "off"
      - condition: state
        entity_id: binary_sensor.masterskaia_balkon_contact
        state: "on"
    action:
      - condition: state
        entity_id: person.master
        state: "home"
      - service: notify.master
        data:
          message: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π –Ω–∏–∂–µ 20¬∞. –≠—Ç–æ –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è, –∞ –Ω–µ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫! –ó–∞–∫—Ä–æ–π—Ç–µ –¥–≤–µ—Ä—å."
      - condition: state
        entity_id: person.tatiana
        state: "home"
      - service: notify.tatsiana
        data:
          message: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π –Ω–∏–∂–µ 20¬∞. –≠—Ç–æ –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è, –∞ –Ω–µ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫! –ó–∞–∫—Ä–æ–π—Ç–µ –¥–≤–µ—Ä—å."
    mode: single

  # –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ó–∞–º–µ–Ω—ã –≠–ª–µ–º–µ–Ω—Ç–∞ –ü–∏—Ç–∞–Ω–∏—è
  # –£–≤–µ–¥–æ–º–ª—è–µ—Ç, –∫–æ–≥–¥–∞ —É—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏ –≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —É–º–Ω–æ–≥–æ –¥–æ–º–∞
  # –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∏–∂–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞.
  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è blueprint - https://gist.github.com/sbyx/1f6f434f0903b872b84c4302637d0890?permalink_comment_id=4135327#file-low-battery-level-detection-notification-for-all-battery-sensors-yaml

  - id: "04c57ac3-56ec-49aa-a30a-4b3bd973eb60"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –ø–∏—Ç–∞–Ω–∏—è"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–º–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è"
    use_blueprint:
      path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
      input:
        threshold: 15
        actions:
          - service: notify.master
            metadata: {}
            data:
              message: '"–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∑–∞–º–µ–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–∏—Ç–∞–Ω–∏—è: {{sensors}}"'

  # –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
  # –ò–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ–± –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Home Assistant,
  # –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è —Å–∏—Å—Ç–µ–º—É –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

  - id: "4c5c8e57-be5b-4380-88a1-4ecc730c19da"
    alias: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –¢–µ–ª–µ–≥—Ä–∞–º: –í–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã"
    description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–∏—Å—Ç–µ–º—ã"
    trigger:
      - platform: state
        entity_id:
          - update.file_editor_update
          - update.home_assistant_core_update
          - update.home_assistant_google_drive_backup_update
          - update.home_assistant_operating_system_update
          - update.home_assistant_supervisor_update
          - update.log_viewer_update
          - update.mosquitto_broker_update
          - update.samba_share_update
          - update.studio_code_server_update
          - update.terminal_ssh_update
          - update.zigbee2mqtt_update
        to: "on"
    action:
      - service: notify.master
        data_template:
          message: >
            {% set entity = trigger.to_state %}
            {% if entity %}
              üÜï –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ: {{ entity.attributes.friendly_name | default('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç') }}
              –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: {{ entity.attributes.installed_version | default('–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ') }}
              –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è: {{ entity.attributes.latest_version | default('–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ') }}
              üìù –°–≤–æ–¥–∫–∞: {{ entity.attributes.release_summary | default('–ù–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π') }}
            {% else %}
              –û—à–∏–±–∫–∞: –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.
            {% endif %}

  - id: "1712827987955"
    alias: –¢–µ–ª–µ–≥—Ä–∞–º. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
    description: ""
    trigger:
      - type: value
        platform: device
        device_id: 66bd0bcf10924787d43265639b39d58a
        entity_id: 668a100b3712c29cbf678b65ae2348ae
        domain: sensor
        below: 10
    condition: []
    action:
      - service: notify.master
        data:
          message: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –≤ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–µ
    mode: single
